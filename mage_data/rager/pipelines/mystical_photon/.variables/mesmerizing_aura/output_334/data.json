{"text": "from pyarrow.parquet import ParquetFile\npf = ParquetFile('fhvhv_tripdata_2021-01.parquet')\n#pyarrow builds tables, not dataframes\ntbl_small = next(pf.iter_batches(batch_size = 1000))\n#this function converts the table to a dataframe of manageable size\ndf = tbl_small.to_pandas()\nAlternatively without PyArrow:\ndf = spark.read.parquet('fhvhv_tripdata_2021-01.parquet')\ndf1 = df.sort('DOLocationID').limit(1000)\npdf = df1.select(\"*\").toPandas()\ngcsu", "section": "Module 5: pyspark", "question": "How can I read a small number of rows from the parquet file directly?", "course": "data-engineering-zoomcamp", "document_id": "3fe85b16"}