{"result_id": "c5558c0b35684342bf2a7182e121c6ed", "data_type": null, "error": {"code": "import re\nfrom typing import Any, Dict, List\n\n\n@transformer\ndef chunk_documents(data: List[Dict[str, Any]], *args, **kwargs):\n    documents = []\n    \n    for idx, item in enumerate(data):\n        course = item['course']\n        \n        for info in item['documents']:\n            section = info['section']\n            question = info['question']\n            answer = info['text']\n            \n            # Generate a unique document ID\n            document_id = ':'.join([re.sub(r'\\W', '_', part) \n\t            for part in [course, section, question]]).lower()\n            \n            # Format the document string\n            chunk = '\\n'.join([\n                f'course:\\n{course}\\n',\n                f'section:\\n{section}\\n',\n                f'question:\\n{question}\\n',\n                f'answer:\\n{answer}\\n',\n            ])\n            \n            documents.append(dict(\n                chunk=chunk,\n                document=info,\n\t            document_id=document_id,\n            ))\n\n    print(f'Documents:', len(documents))\n            \n    return [documents]", "code_context": ["        ", "        for info in item['documents']:", "            section = info['section']", "            question = info['question']", "            answer = info['text']"], "code_context_formatted": ["\u001b[35m  11:         \u001b[0m", "\u001b[35m  12:         for info in item['documents']:\u001b[0m", "\u001b[91m  13:             section = info['section']\u001b[0m", "\u001b[35m  14:             question = info['question']\u001b[0m", "\u001b[35m  15:             answer = info['text']\u001b[0m"], "error": "'documents'", "errors": null, "exception": "KeyError: 'documents'", "line_number": 13, "message": "'documents'", "message_formatted": "'documents'", "stacktrace": ["Traceback (most recent call last):\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\", line 281, in execute_code_async\n    local_variables = await __modify_and_execute(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\", line 135, in __modify_and_execute\n    raise error\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\", line 117, in __modify_and_execute\n    res = await res\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/environments/setup_helpers.py\", line 48, in execute\n    await block.execute(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1711, in execute\n    await loop.run_in_executor(\n", "  File \"/usr/local/lib/python3.10/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1688, in execute_sync\n    return __execute()\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1665, in __execute\n    raise err\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1567, in __execute\n    output = self.execute_block(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1912, in execute_block\n    outputs = self._execute_block(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 2075, in _execute_block\n    outputs = self.execute_block_function(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 2186, in execute_block_function\n    output = block_function_updated(*input_vars, **runtime_variables)\n", "  File \"<string>\", line 13, in chunk_documents\n", "KeyError: 'documents'\n"], "stacktrace_formatted": ["\u001b[91mTraceback (most recent call last):\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\"\u001b[0m, \u001b[36mline 281\u001b[0m, \u001b[35min execute_code_async\n    local_variables = await __modify_and_execute(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\"\u001b[0m, \u001b[36mline 135\u001b[0m, \u001b[35min __modify_and_execute\n    raise error\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\"\u001b[0m, \u001b[36mline 117\u001b[0m, \u001b[35min __modify_and_execute\n    res = await res\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/environments/setup_helpers.py\"\u001b[0m, \u001b[36mline 48\u001b[0m, \u001b[35min execute\n    await block.execute(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1711\u001b[0m, \u001b[35min execute\n    await loop.run_in_executor(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/concurrent/futures/thread.py\"\u001b[0m, \u001b[36mline 58\u001b[0m, \u001b[35min run\n    result = self.fn(*self.args, **self.kwargs)\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1688\u001b[0m, \u001b[35min execute_sync\n    return __execute()\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1665\u001b[0m, \u001b[35min __execute\n    raise err\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1567\u001b[0m, \u001b[35min __execute\n    output = self.execute_block(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1912\u001b[0m, \u001b[35min execute_block\n    outputs = self._execute_block(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 2075\u001b[0m, \u001b[35min _execute_block\n    outputs = self.execute_block_function(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 2186\u001b[0m, \u001b[35min execute_block_function\n    output = block_function_updated(*input_vars, **runtime_variables)\n\u001b[0m", "\u001b[34m  File \"<string>\"\u001b[0m, \u001b[36mline 13\u001b[0m, \u001b[35min chunk_documents\n\u001b[0m", "\u001b[90mKeyError: 'documents'\n\u001b[0m", "\u001b[91m'documents'\u001b[0m"], "type": "KeyError"}, "metadata": null, "output": null, "process": {"data": [], "exitcode": null, "is_alive": false, "internal_state": "INIT", "kernel_uuid": "mesmerizing_aura", "message": "import re\nfrom typing import Any, Dict, List\n\n\n@transformer\ndef chunk_documents(data: List[Dict[str, Any]], *args, **kwargs):\n    documents = []\n    \n    for idx, item in enumerate(data):\n        course = item['course']\n        \n        for info in item['documents']:\n            section = info['section']\n            question = info['question']\n            answer = info['text']\n            \n            # Generate a unique document ID\n            document_id = ':'.join([re.sub(r'\\W', '_', part) \n\t            for part in [course, section, question]]).lower()\n            \n            # Format the document string\n            chunk = '\\n'.join([\n                f'course:\\n{course}\\n',\n                f'section:\\n{section}\\n',\n                f'question:\\n{question}\\n',\n                f'answer:\\n{answer}\\n',\n            ])\n            \n            documents.append(dict(\n                chunk=chunk,\n                document=info,\n\t            document_id=document_id,\n            ))\n\n    print(f'Documents:', len(documents))\n            \n    return [documents]", "message_request_uuid": "1724077700468", "message_uuid": "d54d43812aa04538bce88155c0553740", "output_manager": {"namespace": "pipeline/mystical_photon", "path": "llm/rager/transformers/mesmerizing_aura.py", "uuid": "1724077700468"}, "pid": "d54d43812aa04538bce88155c0553740", "pid_spawn": null, "source": "mesmerizing_aura", "stream": "code_executions", "timestamp": null, "timestamp_end": null, "uuid": "mesmerizing_aura"}, "status": "error", "type": "status", "uuid": "mesmerizing_aura", "timestamp": 1724077707722, "output_text": null}
{"result_id": "24492b2bf3d14ebdbec4d014094f5f01", "data_type": null, "error": null, "metadata": {"namespace": "pipeline/mystical_photon", "path": "llm/rager/transformers/mesmerizing_aura.py", "uuid": "1724077700468", "block_type": "transformer", "block_uuid": "mesmerizing_aura", "execution_partition": null, "pipeline_uuid": "mystical_photon"}, "output": "", "process": {"data": [], "exitcode": null, "is_alive": false, "internal_state": "INIT", "kernel_uuid": "mesmerizing_aura", "message": "import re\nfrom typing import Any, Dict, List\n\n\n@transformer\ndef chunk_documents(data: List[Dict[str, Any]], *args, **kwargs):\n    documents = []\n    \n    for idx, item in enumerate(data):\n        course = item['course']\n        \n        for info in item['documents']:\n            section = info['section']\n            question = info['question']\n            answer = info['text']\n            \n            # Generate a unique document ID\n            document_id = ':'.join([re.sub(r'\\W', '_', part) \n\t            for part in [course, section, question]]).lower()\n            \n            # Format the document string\n            chunk = '\\n'.join([\n                f'course:\\n{course}\\n',\n                f'section:\\n{section}\\n',\n                f'question:\\n{question}\\n',\n                f'answer:\\n{answer}\\n',\n            ])\n            \n            documents.append(dict(\n                chunk=chunk,\n                document=info,\n\t            document_id=document_id,\n            ))\n\n    print(f'Documents:', len(documents))\n            \n    return [documents]", "message_request_uuid": "1724077700468", "message_uuid": "d54d43812aa04538bce88155c0553740", "output_manager": {"namespace": "pipeline/mystical_photon", "path": "llm/rager/transformers/mesmerizing_aura.py", "uuid": "1724077700468"}, "pid": "d54d43812aa04538bce88155c0553740", "pid_spawn": null, "source": "mesmerizing_aura", "stream": "code_executions", "timestamp": null, "timestamp_end": null, "uuid": "mesmerizing_aura"}, "status": "success", "type": "output", "uuid": "mesmerizing_aura", "timestamp": 1724077707733, "output_text": ""}
