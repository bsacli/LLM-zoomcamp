{"result_id": "a26af6a02f8a46d182e4a411c2c5d075", "data_type": null, "error": {"code": "import io\nimport requests\nimport docx\nfrom mage_ai.data_preparation.decorators import custom\nfrom mage_ai.data_preparation.models.block import Block\n\ndef clean_line(line):\n    line = line.strip()\n    line = line.strip('\\uFEFF')\n    return line\n\ndef read_faq(file_id):\n    url = f'https://docs.google.com/document/d/{file_id}/export?format=docx'\n    \n    response = requests.get(url)\n    response.raise_for_status()\n    \n    with io.BytesIO(response.content) as f_in:\n        doc = docx.Document(f_in)\n\n    questions = []\n\n    question_heading_style = 'heading 2'\n    section_heading_style = 'heading 1'\n    \n    section_title = ''\n    question_title = ''\n    answer_text_so_far = ''\n     \n    for p in doc.paragraphs:\n        style = p.style.name.lower()\n        p_text = clean_line(p.text)\n    \n        if len(p_text) == 0:\n            continue\n    \n        if style == section_heading_style:\n            section_title = p_text\n            continue\n    \n        if style == question_heading_style:\n            answer_text_so_far = answer_text_so_far.strip()\n            if answer_text_so_far != '' and section_title != '' and question_title != '':\n                questions.append({\n                    'text': answer_text_so_far,\n                    'section': section_title,\n                    'question': question_title,\n                })\n                answer_text_so_far = ''\n    \n            question_title = p_text\n            continue\n        \n        answer_text_so_far += '\\n' + p_text\n    \n    answer_text_so_far = answer_text_so_far.strip()\n    if answer_text_so_far != '' and section_title != '' and question_title != '':\n        questions.append({\n            'text': answer_text_so_far,\n            'section': section_title,\n            'question': question_title,\n        })\n\n    return questions\n\n@custom\ndef ingest_data(*args, **kwargs):\n    faq_documents = {\n        'llm-faq-v1': '1qZjwHkvP0lXHiE4zdbWyUXSVfmVGzougDD6N37bat3E',\n    }\n\n    documents = []\n\n    for course, file_id in faq_documents.items():\n        print(f\"Processing document for course: {course}\")\n        course_documents = read_faq(file_id)\n        documents.append({'course': course, 'documents': course_documents})\n    \n    # Return the processed documents as the output of this block\n    return documents\n", "code_context": [], "code_context_formatted": [], "error": "Block radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.", "errors": null, "exception": "Exception: Block radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.", "line_number": 1747, "message": "Block radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.", "message_formatted": "Block radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.", "stacktrace": ["Traceback (most recent call last):\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\", line 281, in execute_code_async\n    local_variables = await __modify_and_execute(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\", line 135, in __modify_and_execute\n    raise error\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\", line 117, in __modify_and_execute\n    res = await res\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/environments/setup_helpers.py\", line 48, in execute\n    await block.execute(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1711, in execute\n    await loop.run_in_executor(\n", "  File \"/usr/local/lib/python3.10/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1688, in execute_sync\n    return __execute()\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1665, in __execute\n    raise err\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1567, in __execute\n    output = self.execute_block(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1912, in execute_block\n    outputs = self._execute_block(\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 2063, in _execute_block\n    block_function = self._validate_execution(decorated_functions, input_vars)\n", "  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\", line 1747, in _validate_execution\n    raise Exception(\n", "Exception: Block radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.\n"], "stacktrace_formatted": ["\u001b[91mTraceback (most recent call last):\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\"\u001b[0m, \u001b[36mline 281\u001b[0m, \u001b[35min execute_code_async\n    local_variables = await __modify_and_execute(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\"\u001b[0m, \u001b[36mline 135\u001b[0m, \u001b[35min __modify_and_execute\n    raise error\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/execution.py\"\u001b[0m, \u001b[36mline 117\u001b[0m, \u001b[35min __modify_and_execute\n    res = await res\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/kernels/magic/environments/setup_helpers.py\"\u001b[0m, \u001b[36mline 48\u001b[0m, \u001b[35min execute\n    await block.execute(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1711\u001b[0m, \u001b[35min execute\n    await loop.run_in_executor(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/concurrent/futures/thread.py\"\u001b[0m, \u001b[36mline 58\u001b[0m, \u001b[35min run\n    result = self.fn(*self.args, **self.kwargs)\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1688\u001b[0m, \u001b[35min execute_sync\n    return __execute()\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1665\u001b[0m, \u001b[35min __execute\n    raise err\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1567\u001b[0m, \u001b[35min __execute\n    output = self.execute_block(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1912\u001b[0m, \u001b[35min execute_block\n    outputs = self._execute_block(\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 2063\u001b[0m, \u001b[35min _execute_block\n    block_function = self._validate_execution(decorated_functions, input_vars)\n\u001b[0m", "\u001b[34m  File \"/usr/local/lib/python3.10/site-packages/mage_ai/data_preparation/models/block/__init__.py\"\u001b[0m, \u001b[36mline 1747\u001b[0m, \u001b[35min _validate_execution\n    raise Exception(\n\u001b[0m", "\u001b[90mException: Block radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.\n\u001b[0m", "\u001b[91mBlock radiant_nexus does not have any decorated functions. Make sure that a function in the block is decorated with @data_loader.\u001b[0m"], "type": "Exception"}, "metadata": null, "output": null, "process": {"data": [], "exitcode": null, "is_alive": false, "internal_state": "INIT", "kernel_uuid": "radiant_nexus", "message": "import io\nimport requests\nimport docx\nfrom mage_ai.data_preparation.decorators import custom\nfrom mage_ai.data_preparation.models.block import Block\n\ndef clean_line(line):\n    line = line.strip()\n    line = line.strip('\\uFEFF')\n    return line\n\ndef read_faq(file_id):\n    url = f'https://docs.google.com/document/d/{file_id}/export?format=docx'\n    \n    response = requests.get(url)\n    response.raise_for_status()\n    \n    with io.BytesIO(response.content) as f_in:\n        doc = docx.Document(f_in)\n\n    questions = []\n\n    question_heading_style = 'heading 2'\n    section_heading_style = 'heading 1'\n    \n    section_title = ''\n    question_title = ''\n    answer_text_so_far = ''\n     \n    for p in doc.paragraphs:\n        style = p.style.name.lower()\n        p_text = clean_line(p.text)\n    \n        if len(p_text) == 0:\n            continue\n    \n        if style == section_heading_style:\n            section_title = p_text\n            continue\n    \n        if style == question_heading_style:\n            answer_text_so_far = answer_text_so_far.strip()\n            if answer_text_so_far != '' and section_title != '' and question_title != '':\n                questions.append({\n                    'text': answer_text_so_far,\n                    'section': section_title,\n                    'question': question_title,\n                })\n                answer_text_so_far = ''\n    \n            question_title = p_text\n            continue\n        \n        answer_text_so_far += '\\n' + p_text\n    \n    answer_text_so_far = answer_text_so_far.strip()\n    if answer_text_so_far != '' and section_title != '' and question_title != '':\n        questions.append({\n            'text': answer_text_so_far,\n            'section': section_title,\n            'question': question_title,\n        })\n\n    return questions\n\n@custom\ndef ingest_data(*args, **kwargs):\n    faq_documents = {\n        'llm-faq-v1': '1qZjwHkvP0lXHiE4zdbWyUXSVfmVGzougDD6N37bat3E',\n    }\n\n    documents = []\n\n    for course, file_id in faq_documents.items():\n        print(f\"Processing document for course: {course}\")\n        course_documents = read_faq(file_id)\n        documents.append({'course': course, 'documents': course_documents})\n    \n    # Return the processed documents as the output of this block\n    return documents\n", "message_request_uuid": "1724229618716", "message_uuid": "18835d1a951d4864b40ff7ca48e91cee", "output_manager": {"namespace": "pipeline/cosmic_continuum", "path": "llm/rager/data_loaders/radiant_nexus.py", "uuid": "1724229618716"}, "pid": "18835d1a951d4864b40ff7ca48e91cee", "pid_spawn": null, "source": "radiant_nexus", "stream": "code_executions", "timestamp": null, "timestamp_end": null, "uuid": "radiant_nexus"}, "status": "error", "type": "status", "uuid": "radiant_nexus", "timestamp": 1724229621417, "output_text": null}
{"result_id": "49cfb5d096dc40f8a368d400378014aa", "data_type": null, "error": null, "metadata": {"namespace": "pipeline/cosmic_continuum", "path": "llm/rager/data_loaders/radiant_nexus.py", "uuid": "1724229618716", "block_type": "data_loader", "block_uuid": "radiant_nexus", "execution_partition": null, "pipeline_uuid": "cosmic_continuum"}, "output": "", "process": {"data": [], "exitcode": null, "is_alive": false, "internal_state": "INIT", "kernel_uuid": "radiant_nexus", "message": "import io\nimport requests\nimport docx\nfrom mage_ai.data_preparation.decorators import custom\nfrom mage_ai.data_preparation.models.block import Block\n\ndef clean_line(line):\n    line = line.strip()\n    line = line.strip('\\uFEFF')\n    return line\n\ndef read_faq(file_id):\n    url = f'https://docs.google.com/document/d/{file_id}/export?format=docx'\n    \n    response = requests.get(url)\n    response.raise_for_status()\n    \n    with io.BytesIO(response.content) as f_in:\n        doc = docx.Document(f_in)\n\n    questions = []\n\n    question_heading_style = 'heading 2'\n    section_heading_style = 'heading 1'\n    \n    section_title = ''\n    question_title = ''\n    answer_text_so_far = ''\n     \n    for p in doc.paragraphs:\n        style = p.style.name.lower()\n        p_text = clean_line(p.text)\n    \n        if len(p_text) == 0:\n            continue\n    \n        if style == section_heading_style:\n            section_title = p_text\n            continue\n    \n        if style == question_heading_style:\n            answer_text_so_far = answer_text_so_far.strip()\n            if answer_text_so_far != '' and section_title != '' and question_title != '':\n                questions.append({\n                    'text': answer_text_so_far,\n                    'section': section_title,\n                    'question': question_title,\n                })\n                answer_text_so_far = ''\n    \n            question_title = p_text\n            continue\n        \n        answer_text_so_far += '\\n' + p_text\n    \n    answer_text_so_far = answer_text_so_far.strip()\n    if answer_text_so_far != '' and section_title != '' and question_title != '':\n        questions.append({\n            'text': answer_text_so_far,\n            'section': section_title,\n            'question': question_title,\n        })\n\n    return questions\n\n@custom\ndef ingest_data(*args, **kwargs):\n    faq_documents = {\n        'llm-faq-v1': '1qZjwHkvP0lXHiE4zdbWyUXSVfmVGzougDD6N37bat3E',\n    }\n\n    documents = []\n\n    for course, file_id in faq_documents.items():\n        print(f\"Processing document for course: {course}\")\n        course_documents = read_faq(file_id)\n        documents.append({'course': course, 'documents': course_documents})\n    \n    # Return the processed documents as the output of this block\n    return documents\n", "message_request_uuid": "1724229618716", "message_uuid": "18835d1a951d4864b40ff7ca48e91cee", "output_manager": {"namespace": "pipeline/cosmic_continuum", "path": "llm/rager/data_loaders/radiant_nexus.py", "uuid": "1724229618716"}, "pid": "18835d1a951d4864b40ff7ca48e91cee", "pid_spawn": null, "source": "radiant_nexus", "stream": "code_executions", "timestamp": null, "timestamp_end": null, "uuid": "radiant_nexus"}, "status": "success", "type": "output", "uuid": "radiant_nexus", "timestamp": 1724229621443, "output_text": ""}
