{"result_id": "99320ff0ce5144b09fa40c54b6c0ce93", "data_type": null, "error": null, "metadata": {"namespace": "pipeline/illuminating_zenith", "path": "llm/rager/data_loaders/metaphysical_elysium.py", "uuid": "1724235343243", "block_type": "data_loader", "block_uuid": "metaphysical_elysium", "execution_partition": null, "pipeline_uuid": "illuminating_zenith"}, "output": "", "process": {"data": [], "exitcode": null, "is_alive": false, "internal_state": "INIT", "kernel_uuid": "metaphysical_elysium", "message": "from elasticsearch import Elasticsearch, exceptions\nfrom mage_ai.data_preparation.decorators import data_exporter\n\n@data_loader\ndef test_retrieval(*args, **kwargs):\n    index_name = kwargs.get('index_name', 'documents_20240821_5013')\n    query = kwargs.get('query', 'When is the next cohort?')\n    connection_string = kwargs.get('connection_string', 'http://localhost:9200')\n    \n    es_client = Elasticsearch([connection_string])\n    \n    search_query = {\n        \"size\": 1,\n        \"query\": {\n            \"match\": {\n                \"text\": query\n            }\n        }\n    }\n    \n    try:\n        response = es_client.search(\n            index=index_name,\n            body=search_query\n        )\n        \n        if response['hits']['hits']:\n            top_result = response['hits']['hits'][0]\n            return top_result['_id']\n        else:\n            return \"No results found.\"\n    \n    except exceptions.NotFoundError as e:\n        return f\"IndexNotFoundError: {e.info}\"\n    except exceptions.RequestError as e:\n        return f\"RequestError: {e.info}\"\n    except exceptions.TransportError as e:\n        return f\"TransportError: {e.info}\"\n    except Exception as e:\n        return f\"Unexpected error: {e}\"\n", "message_request_uuid": "1724235343243", "message_uuid": "0f46330aecb046f3ad380989d93761fc", "output_manager": {"namespace": "pipeline/illuminating_zenith", "path": "llm/rager/data_loaders/metaphysical_elysium.py", "uuid": "1724235343243"}, "pid": "0f46330aecb046f3ad380989d93761fc", "pid_spawn": null, "source": "metaphysical_elysium", "stream": "code_executions", "timestamp": null, "timestamp_end": null, "uuid": "metaphysical_elysium"}, "status": "success", "type": "output", "uuid": "metaphysical_elysium", "timestamp": 1724235343287, "output_text": ""}
