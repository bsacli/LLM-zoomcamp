{"result_id": "17e33e5b41b244538f956d6c0caa043d", "data_type": null, "error": null, "metadata": {"namespace": "pipeline/illuminating_zenith", "path": "llm/rager/data_loaders/metaphysical_elysium.py", "uuid": "1724235410951", "block_type": "data_loader", "block_uuid": "metaphysical_elysium", "execution_partition": null, "pipeline_uuid": "illuminating_zenith"}, "output": "", "process": {"data": [], "exitcode": null, "is_alive": false, "internal_state": "INIT", "kernel_uuid": "metaphysical_elysium", "message": "from elasticsearch import Elasticsearch, exceptions\nfrom mage_ai.data_preparation.decorators import data_exporter\n\n@data_loader\ndef test_retrieval(*args, **kwargs):\n    index_name = kwargs.get('index_name', 'documents_20240821_*')\n    query = kwargs.get('query', 'When is the next cohort?')\n    connection_string = kwargs.get('connection_string', 'http://localhost:9200')\n    \n    es_client = Elasticsearch([connection_string])\n    \n    search_query = {\n        \"size\": 1,\n        \"query\": {\n            \"match\": {\n                \"text\": query\n            }\n        }\n    }\n    \n    try:\n        response = es_client.search(\n            index=index_name,\n            body=search_query\n        )\n        \n        if response['hits']['hits']:\n            top_result = response['hits']['hits'][0]\n            return top_result['_id']\n        else:\n            return \"No results found.\"\n    \n    except exceptions.NotFoundError as e:\n        return f\"IndexNotFoundError: {e.info}\"\n    except exceptions.RequestError as e:\n        return f\"RequestError: {e.info}\"\n    except exceptions.TransportError as e:\n        return f\"TransportError: {e.info}\"\n    except Exception as e:\n        return f\"Unexpected error: {e}\"\n", "message_request_uuid": "1724235410951", "message_uuid": "8f231e20b88a466fac0e38ed6a910f18", "output_manager": {"namespace": "pipeline/illuminating_zenith", "path": "llm/rager/data_loaders/metaphysical_elysium.py", "uuid": "1724235410951"}, "pid": "8f231e20b88a466fac0e38ed6a910f18", "pid_spawn": null, "source": "metaphysical_elysium", "stream": "code_executions", "timestamp": null, "timestamp_end": null, "uuid": "metaphysical_elysium"}, "status": "success", "type": "output", "uuid": "metaphysical_elysium", "timestamp": 1724235411039, "output_text": ""}
